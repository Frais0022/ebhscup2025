<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>REMI OYEBADE Interhouse Football Competition 2025— Live</title>
<style>
body { font-family: Arial, sans-serif; background: #f0f4f8; padding: 20px; }
h1 { text-align: center; }
.container { max-width: 900px; margin: auto; }
.card { background: #fff; border-radius: 10px; padding: 12px; margin: 12px 0; box-shadow: 0 2px 8px rgba(0,0,0,0.1); }
.slot { border: 1px solid #ddd; border-radius: 8px; padding: 10px; margin-bottom: 10px; display:flex; align-items:center; justify-content: space-between; }
.slot img { width: 48px; height: 48px; object-fit: cover; border-radius: 8px; margin-left: 8px; }
input, button, textarea { padding:6px; border-radius:6px; border:1px solid #ccc; margin-top:4px; }
button { background:#0369a1; color:#fff; border:none; cursor:pointer; }
button:disabled { opacity:0.6; cursor:not-allowed; }
.muted { color:#555; font-size:13px; }
table { width:100%; border-collapse: collapse; margin-top:8px; }
th,td { border:1px solid #ddd; padding:6px; text-align:center; }
th { background:#0369a1; color:white; }
#countdown { text-align:center; font-weight:bold; margin-bottom:12px; }
#shareLink { text-align:center; display:block; font-size:14px; color:#0369a1; word-break:break-all; }
</style>
</head>
<body>

<!-- Team Slots -->
<div class="card">
<h3>Team Slots — Representatives Claim Here</h3>
<div id="slotsRow"></div>
<div class="muted">First-come-first-serve. Enter team name and optional logo, then click Claim.</div>
</div>

<!-- Semi-Finals -->
<div class="card" id="semiCard" style="display:none">
<h3>Semi-Finals</h3>
<div id="semiFixtures"></div>
</div>

<!-- Final -->
<div class="card" id="finalCard" style="display:none">
<h3>Final</h3>
<div id="finalFixture"></div>
</div>

<!-- Global Scorers -->
<div class="card">
<h3>Competition Scorers Ranking (Live)</h3>
<div id="globalLeaderboard"></div>
</div>
</div>

<script>
/* ===== CONFIG ===== */
const BIN_ID = "YOUR_JSONBIN_BIN_ID";        // replace with your JSONBin bin id
const API_KEY = "YOUR_JSONBIN_API_KEY";      // replace with your JSONBin secret key
const ADMIN_PASSWORD = "REMI2025";
const TOTAL_SLOTS = 4;
const COMP_DATE = new Date("December 8, 2025 08:30:00").getTime();
let remoteData = null;

/* --- Shareable Link --- */
function updateShareLink(){
  const u = new URL(location.href);
  document.getElementById('shareLink').textContent = u.toString();
}
updateShareLink();

/* --- Countdown --- */
function updateCountdown(){
  const el = document.getElementById('countdown');
  const diff = COMP_DATE - Date.now();
  if(diff <=0){ el.textContent="Competition is LIVE!"; return; }
  const d=Math.floor(diff/(1000*60*60*24));
  const h=Math.floor((diff%(1000*60*60*24))/(1000*60*60));
  const m=Math.floor((diff%(1000*60*60))/(1000*60));
  const s=Math.floor((diff%(1000*60))/1000);
  el.textContent=`Starts in ${d}d ${h}h ${m}m ${s}s`;
}
setInterval(updateCountdown,1000);
updateCountdown();

/* --- Utilities --- */
async function fetchData(){
  try {
    const res = await fetch(`https://api.jsonbin.io/v3/b/${BIN_ID}/latest`, {
      headers: { "X-Master-Key": API_KEY }
    });
    const json = await res.json();
    remoteData = normalize(json.record);
    renderAll();
  } catch(e){ console.error("Fetch error:", e); }
}

async function pushData(){
  try{
    await fetch(`https://api.jsonbin.io/v3/b/${BIN_ID}`, {
      method:"PUT",
      headers: { "Content-Type":"application/json","X-Master-Key": API_KEY },
      body: JSON.stringify(remoteData)
    });
  }catch(e){ console.error("Push error:",e); }
}

/* Normalize structure */
function normalize(d){
  if(!d) d = {};
  d.slots = d.slots && d.slots.length===TOTAL_SLOTS ? d.slots : Array.from({length:TOTAL_SLOTS},()=>({name:'',logo:''}));
  d.fixtures = d.fixtures || { semi:null, final:null, scores:[[0,0],[0,0]], finalScore:[0,0], chat:[[],[]], finalChat:[] };
  d.fixtures.chat = d.fixtures.chat || [[],[]];
  d.fixtures.finalChat = d.fixtures.finalChat || [];
  return d;
}

/* --- Render --- */
function renderAll(){
  renderSlots();
  renderFixtures();
  renderLeaderboard();
}

/* --- Slots --- */
function renderSlots(){
  const row = document.getElementById('slotsRow');
  row.innerHTML='';
  remoteData.slots.forEach((slot,index)=>{
    const div=document.createElement('div');
    div.className='slot';
    if(!slot.name){
      div.innerHTML=`<div>
        <strong>Slot ${index+1}</strong><br>
        <input id="teamName_${index}" placeholder="Team name"><br>
        <input id="teamLogo_${index}" type="file" accept="image/*">
      </div>
      <button onclick="claimSlot(${index})">Claim Slot</button>`;
    }else{
      const logoTag=slot.logo?`<img src="${slot.logo}" alt="logo">`:'';
      div.innerHTML=`<strong>Slot ${index+1}</strong> - ${slot.name} ${logoTag}`;
    }
    row.appendChild(div);
  });
}

/* Claim slot */
function claimSlot(index){
  const nameEl=document.getElementById(`teamName_${index}`);
  const logoEl=document.getElementById(`teamLogo_${index}`);
  const name=nameEl.value.trim();
  if(!name) return alert("Enter team name");
  if(remoteData.slots[index].name) return alert("Slot already claimed");

  if(logoEl.files && logoEl.files[0]){
    const reader=new FileReader();
    reader.onload=e=>{
      remoteData.slots[index]={name,logo:e.target.result};
      renderAll();
      pushData();
      autoGenerateFixtures();
    }
    reader.readAsDataURL(logoEl.files[0]);
  }else{
    remoteData.slots[index]={name,logo:''};
    renderAll();
    pushData();
    autoGenerateFixtures();
  }
}

/* --- Auto-generate Fixtures when all slots claimed --- */
function autoGenerateFixtures(){
  if(remoteData.slots.every(s=>s.name) && !remoteData.fixtures.semi){
    const teams=[...remoteData.slots];
    for(let i=teams.length-1;i>0;i--){
      const j=Math.floor(Math.random()*(i+1));
      [teams[i],teams[j]]=[teams[j],teams[i]];
    }
    remoteData.fixtures.semi=[
      {team1:teams[0],team2:teams[1]},
      {team1:teams[2],team2:teams[3]}
    ];
    remoteData.fixtures.scores=[[0,0],[0,0]];
    remoteData.fixtures.chat=[[],[]];
    remoteData.fixtures.final=null;
    remoteData.fixtures.finalScore=[0,0];
    remoteData.fixtures.finalChat=[];
    pushData();
  }
}

/* --- Render Fixtures --- */
function renderFixtures(){
  const semiDiv=document.getElementById('semiFixtures');
  const finalDiv=document.getElementById('finalFixture');
  if(remoteData.fixtures.semi){
    document.getElementById('semiCard').style.display='block';
    semiDiv.innerHTML='';
    remoteData.fixtures.semi.forEach((m,idx)=>{
      const scores=remoteData.fixtures.scores[idx];
      const scorers=remoteData.fixtures.chat[idx].map(c=>c.scorer+':'+c.goals).join(', ');
      const div=document.createElement('div');
      div.className='card';
      div.innerHTML=`<strong>${m.team1.name} vs ${m.team2.name}</strong><br>
        Score: <input id="scoreA_${idx}" type="number" min="0" value="${scores[0]}"> -
               <input id="scoreB_${idx}" type="number" min="0" value="${scores[1]}"><br>
        <label>Scorers list e.g. John:2, Mary:1</label><br>
        <textarea id="scorers_${idx}">${scorers}</textarea><br>
        <input id="pass_${idx}" type="password" placeholder="Admin password">
        <button onclick="saveMatch(${idx})">Save Match (Admin)</button>`;
      semiDiv.appendChild(div);
    });
  }else semiDiv.innerHTML='';

  if(remoteData.fixtures.final){
    document.getElementById('finalCard').style.display='block';
    const f=remoteData.fixtures.final;
    const s=remoteData.fixtures.finalScore;
    const sc=remoteData.fixtures.finalChat.map(c=>c.scorer+':'+c.goals).join(', ');
    finalDiv.innerHTML=`<strong>${f.team1.name} vs ${f.team2.name}</strong><br>
      Score: <input id="finalA" type="number" min="0" value="${s[0]}"> -
             <input id="finalB" type="number" min="0" value="${s[1]}"><br>
      <label>Final scorers list</label><br>
      <textarea id="finalScorers">${sc}</textarea><br>
      <input id="finalPass" type="password" placeholder="Admin password">
      <button onclick="saveFinal()">Save Final (Admin)</button>`;
  }else finalDiv.innerHTML='';
}

/* --- Parse scorers string --- */
function parseScorers(text){
  if(!text) return [];
  return text.split(/[,;]+/).map(s=>{
    const m=s.trim().match(/^(.+?)[:\- ]+(\d+)$/);
    return m?{scorer:m[1].trim(),goals:parseInt(m[2],10)}:{scorer:s.trim(),goals:1};
  });
}

/* --- Save Semi Match --- */
function saveMatch(idx){
  const pass=document.getElementById(`pass_${idx}`).value;
  if(pass!==ADMIN_PASSWORD) return alert("Wrong admin password");
  const scoreA=parseInt(document.getElementById(`scoreA_${idx}`).value)||0;
  const scoreB=parseInt(document.getElementById(`scoreB_${idx}`).value)||0;
  const scorers=parseScorers(document.getElementById(`scorers_${idx}`).value);

  remoteData.fixtures.scores[idx]=[scoreA,scoreB];
  remoteData.fixtures.chat[idx]=scorers;

  const winners=[];
  const semi=remoteData.fixtures.semi;
  winners[0]=scoreA>scoreB?semi[0].team1:scoreB>scoreA?semi[0].team2:null;
  winners[1]=remoteData.fixtures.scores[1][0]>remoteData.fixtures.scores[1][1]?semi[1].team1:remoteData.fixtures.scores[1][1]>remoteData.fixtures.scores[1][0]?semi[1].team2:null;

  if(winners[0] && winners[1]){
    remoteData.fixtures.final={team1:winners[0],team2:winners[1]};
    remoteData.fixtures.finalScore=[0,0];
    remoteData.fixtures.finalChat=[];
  }
  pushData();
  renderAll();
}

/* --- Save Final --- */
function saveFinal(){
  const pass=document.getElementById("finalPass").value;
  if(pass!==ADMIN_PASSWORD) return alert("Wrong admin password");
  const sA=parseInt(document.getElementById("finalA").value)||0;
  const sB=parseInt(document.getElementById("finalB").value)||0;
  const scorers=parseScorers(document.getElementById("finalScorers").value);

  remoteData.fixtures.finalScore=[sA,sB];
  remoteData.fixtures.finalChat=scorers;
  pushData();
  renderAll();
}

/* --- Global Leaderboard --- */
function renderLeaderboard(){
  const out={};
  if(remoteData.fixtures.semi){
    remoteData.fixtures.chat.forEach((c,idx)=>{ c.forEach(e=>{ out[e.scorer]=(out[e.scorer]||0)+e.goals; }); });
  }
  remoteData.fixtures.finalChat.forEach(e=>{ out[e.scorer]=(out[e.scorer]||0)+e.goals; });

  const arr=Object.keys(out).map(k=>({name:k,goals:out[k]})).sort((a,b)=>b.goals-a.goals);
  const div=document.getElementById("globalLeaderboard");
  if(arr.length===0) div.innerHTML='<div class="muted">No scorers yet</div>';
  else{
    div.innerHTML='<table><tr><th>Rank</th><th>Scorer</th><th>Goals</th></tr>'+
      arr.map((r,i)=>`<tr><td>${i+1}</td><td>${r.name}</td><td>${r.goals}</td></tr>`).join('')+'</table>';
  }
}

/* --- Poll backend every 3s --- */
fetchData();
setInterval(fetchData,3000);
</script>
</body>
</html>￼Enter<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>EBHS Interhouse Football — Live</title>
<style>
body { font-family: Arial, sans-serif; background: #f0f4f8; padding: 20px; }
h1 { text-align: center; }
.container { max-width: 900px; margin: auto; }
.card { background: #fff; border-radius: 10px; padding: 12px; margin: 12px 0; box-shadow: 0 2px 8px rgba(0,0,0,0.1); }
.slot { border: 1px solid #ddd; border-radius: 8px; padding: 10px; margin-bottom: 10px; display:flex; align-items:center; justify-content: space-between; }
.slot img { width: 48px; height: 48px; object-fit: cover; border-radius: 8px; margin-left: 8px; }
input, button, textarea { padding:6px; border-radius:6px; border:1px solid #ccc; margin-top:4px; }
button { background:#0369a1; color:#fff; border:none; cursor:pointer; }
button:disabled { opacity:0.6; cursor:not-allowed; }
.muted { color:#555; font-size:13px; }
table { width:100%; border-collapse: collapse; margin-top:8px; }
th,td { border:1px solid #ddd; padding:6px; text-align:center; }
th { background:#0369a1; color:white; }
#countdown { text-align:center; font-weight:bold; margin-bottom:12px; }
#shareLink { text-align:center; display:block; font-size:14px; color:#0369a1; word-break:break-all; }
</style>
</head>
<body>
<div class="container">
<h1>EBHS Interhouse Football — Live Competition</h1>
<div id="countdown">Loading countdown...</div>
<div>Shareable link: <span id="shareLink"></span></div>

<!-- Team Slots -->
<div class="card">
<h3>Team Slots — Representatives Claim Here</h3>
<div id="slotsRow"></div>
<div class="muted">First-come-first-serve. Enter team name and optional logo, then click Claim.</div>
</div>

<!-- Semi-Finals -->
<div class="card" id="semiCard" style="display:none">
<h3>Semi-Finals</h3>
<div id="semiFixtures"></div>
</div>

<!-- Final -->
<div class="card" id="finalCard" style="display:none">
<h3>Final</h3>
<div id="finalFixture"></div>
</div>

<!-- Global Scorers -->
<div class="card">
<h3>Competition Scorers Ranking (Live)</h3>
<div id="globalLeaderboard"></div>
</div>
</div>

<script>
/* ===== CONFIG ===== */
const BIN_ID = "YOUR_JSONBIN_BIN_ID";        // replace with your JSONBin bin id
const API_KEY = "YOUR_JSONBIN_API_KEY";      // replace with your JSONBin secret key
const ADMIN_PASSWORD = "REMI2025";
const TOTAL_SLOTS = 4;
const COMP_DATE = new Date("December 8, 2025 08:30:00").getTime();
let remoteData = null;

/* --- Shareable Link --- */
function updateShareLink(){
  const u = new URL(location.href);
  document.getElementById('shareLink').textContent = u.toString();
}
updateShareLink();

/* --- Countdown --- */
function updateCountdown(){
  const el = document.getElementById('countdown');
  const diff = COMP_DATE - Date.now();
  if(diff <=0){ el.textContent="Competition is LIVE!"; return; }
  const d=Math.floor(diff/(1000*60*60*24));
  const h=Math.floor((diff%(1000*60*60*24))/(1000*60*60));
  const m=Math.floor((diff%(1000*60*60))/(1000*60));
  const s=Math.floor((diff%(1000*60))/1000);
  el.textContent=`Starts in ${d}d ${h}h ${m}m ${s}s`;
}
setInterval(updateCountdown,1000);
updateCountdown();

/* --- Utilities --- */
async function fetchData(){
  try {
    const res = await fetch(`https://api.jsonbin.io/v3/b/${BIN_ID}/latest`, {
      headers: { "X-Master-Key": API_KEY }
    });
    const json = await res.json();
    remoteData = normalize(json.record);
    renderAll();
tch(e){ console.error("Fetch error:", e); }
}

async function pushData(){
  try{
    await fetch(`https://api.jsonbin.io/v3/b/${BIN_ID}`, {
      method:"PUT",
      headers: { "Content-Type":"application/json","X-Master-Key": API_KEY },
      body: JSON.stringify(remoteData)
    });
  }catch(e){ console.error("Push error:",e); }
}

/* Normalize structure */
function normalize(d){
  if(!d) d = {};
  d.slots = d.slots && d.slots.length===TOTAL_SLOTS ? d.slots : Array.from({length:TOTAL_SLOTS},()=>({name:'',logo:''}));
  d.fixtures = d.fixtures || { semi:null, final:null, scores:[[0,0],[0,0]], finalScore:[0,0], chat:[[],[]], finalChat:[] };
  d.fixtures.chat = d.fixtures.chat || [[],[]];
  d.fixtures.finalChat = d.fixtures.finalChat || [];
  return d;
}

/* --- Render --- */
function renderAll(){
  renderSlots();
  renderFixtures();
  renderLeaderboard();
}

/* --- Slots --- */
function renderSlots(){
  const row = document.getElementById('slotsRow');
  row.innerHTML='';
  remoteData.slots.forEach((slot,index)=>{
    const div=document.createElement('div');
    div.className='slot';
    if(!slot.name){
      div.innerHTML=`<div>
        <strong>Slot ${index+1}</strong><br>
        <input id="teamName_${index}" placeholder="Team name"><br>
        <input id="teamLogo_${index}" type="file" accept="image/*">
      </div>
      <button onclick="claimSlot(${index})">Claim Slot</button>`;
    }else{
      const logoTag=slot.logo?`<img src="${slot.logo}" alt="logo">`:'';
      div.innerHTML=`<strong>Slot ${index+1}</strong> - ${slot.name} ${logoTag}`;
    }
    row.appendChild(div);
  });
}

/* Claim slot */
function claimSlot(index){
  const nameEl=document.getElementById(`teamName_${index}`);
  const logoEl=document.getElementById(`teamLogo_${index}`);
  const name=nameEl.value.trim();
  if(!name) return alert("Enter team name");
  if(remoteData.slots[index].name) return alert("Slot already claimed");

  if(logoEl.files && logoEl.files[0]){
    const reader=new FileReader();
    reader.onload=e=>{
      remoteData.slots[index]={name,logo:e.target.result};
      renderAll();
      pushData();
      autoGenerateFixtures();
    }
    reader.readAsDataURL(logoEl.files[0]);
  }else{
    remoteData.slots[index]={name,logo:''};
    renderAll();
    pushData();
    autoGenerateFixtures();
  }
}

/* --- Auto-generate Fixtures when all slots claimed --- */
function autoGenerateFixtures(){
  if(remoteData.slots.every(s=>s.name) && !remoteData.fixtures.semi){
    const teams=[...remoteData.slots];
    for(let i=teams.length-1;i>0;i--){
      const j=Math.floor(Math.random()*(i+1));
      [teams[i],teams[j]]=[teams[j],teams[i]];
    }
    remoteData.fixtures.semi=[
      {team1:teams[0],team2:teams[1]},
      {team1:teams[2],team2:teams[3]}
    ];
    remoteData.fixtures.scores=[[0,0],[0,0]];
    remoteData.fixtures.chat=[[],[]];
    remoteData.fixtures.final=null;
    remoteData.fixtures.finalScore=[0,0];
    remoteData.fixtures.finalChat=[];
    pushData();
  }
}

/* --- Render Fixtures --- */
function renderFixtures(){
  const semiDiv=document.getElementById('semiFixtures');
  const finalDiv=document.getElementById('finalFixture');
  if(remoteData.fixtures.semi){
